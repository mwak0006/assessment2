---
title: "Assessment 2"
author: "Mitchell Wake and Hongmei Zhang"
date: "2023-11-07"
output: 
  bookdown::html_document2:
    css: "style.css"
    number_sections: false 
bibliography: references.bib
csl: apa.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(tidyverse)
library(kableExtra)
library(ggplot2)
library(knitr)
library(plotly)
library(kableExtra)
df <- read.csv("data/cleaned_data.csv")

```



# Introduction

In recent years, the relationship between economic indicators and health outcomes has become a focal point of research, especially within the context of OECD countries. This study aims to explore two critical economic aspects: Gross Net Income (GNI) per Capita and Health Expenditure as a percentage of GDP and the impact these measures have on health outcomes. Our research is guided by two primary questions. Firstly, we investigate the relationship between GNI Per Capita and the infant mortality rate among children under 5 years. Secondly, we explore the correlation between GNI Per Capita and life expectancy at birth. The significance of this study lies in its potential to uncover the intricacies of how economic prosperity, as measured by GNI per capita, influences essential health metrics like infant mortality and life expectancy.

Moreover, the study extends to a detailed examination of health expenditure as a percentage of GDP and its relation to life expectancy and infant mortality rates. We delve into various healthcare systems, ranging from universal to insurance-based and mixed systems, providing a broader perspective on healthcare efficiency across different economic and demographic backgrounds. This comparative analysis is crucial for understanding how healthcare investment affects health outcomes and for identifying potential areas for policy improvement. Special attention is given to the case studies of countries like Mexico and South Korea, which have undergone significant health reforms, and Japan, known for its large population and aging demographics. Through this multifaceted approach, the research aims to offer valuable insights into the dynamics of health economics, shedding light on the effectiveness of healthcare spending and the factors influencing health outcomes in diverse settings.


For our analysis, we utilised the [World Development Indicators dataset](https://databank.worldbank.org/source/world-development-indicators#) provided by the World Bank. We focused on data spanning from 2000 to 2020 for OECD countries, with the exception of Greece, where data was excluded due to missing values. The variables considered for our analysis include:


```{r echo=FALSE}
vardescription <- read.csv("data/variable_description.csv")
vardescription %>% kable(caption="Variable Descriptions" ) %>% kable_styling(full_width = FALSE,position='left')
```



# Analysis by Mitch

In this analysis we aim to explore the relationship between Gross Net Income (GNI) per Capita and key health indicators, specifically focusing on infant mortality and life expectancy. The two research questions are as follows

1. Is there a relationship between GNI Per Capita and the infant mortality rate among children aged less than 5 years in OECD Countries?

2. Is there a relationship between GNI Per Capita and life expectancy at birth of countries in the OECD?


In the Figure \@ref(fig:scatterplot1), a scatterplot shows the relationship between Mortality Rates among children under 5 and GNI Per Capita for OECD countries spanning the years 2000 to 2022. The plot illustrates a downward trend, indicating that as GNI Per Capita rises, there is a tendency for infant mortality to decline.

```{r scatterplot1, fig.cap="Scatter Plot of Mortality Rate Under 5 years and GNI Per Capita", message=FALSE}
df %>%
  ggplot(aes(x = GNIPerCapita, y = Mortality_U5_Total)) + 
  geom_point() +
  geom_smooth( se = FALSE) +
  theme_minimal() +
  labs(title="Scatter Plot of Mortality Rate Under 5 years and GNI Per Capita",
       subtitle="OECD Countries from 2000 to 2022",
       y="Mortality Rate Under 5 years",
       x="GNI Per Capita") 
```
In the next Figure \@ref(fig:scatterplot2), a scatterplot shows the relationship between Life Expectancy at birth and GNI Per Capita for OECD countries spanning the years 2000 to 2022. The plot illustrates an upward trend, indicating that as GNI Per Capita rises, Life Expectancy increases.

```{r scatterplot2, fig.cap="Scatter Plot of Life Expectancy and GNI Per Capita", message=FALSE}
df %>%
  ggplot(aes(x = GNIPerCapita, y = LifeExp_Total)) + 
  geom_point() +
  geom_smooth( se = FALSE) +
  theme_minimal() +
  labs(title="Scatter Plot of Life Expectancy and GNI Per Capita",
       subtitle="OECD Countries from 2000 to 2022",
       y="Life Expectancy at birth",
       x="GNI Per Capita") 
```
To measure the strength of these associations, correlation coefficients were calculated for GNI Per Capita with Mortality Rates and Life Expectancy. Referring to Table \@ref(tab:correlations), the results show a moderately negative correlation of **-0.526** between GNI and Mortality, indicating an inverse relationship. Conversely, a positive correlation of **0.706** is observed between GNI and Life Expectancy, showing a strong positive relationship.


```{r correlations, fig.cap="GNI Per Capita Correlation to Mortality and Life Expectancy"}
df %>%
  summarize(Mortality_U5_correlation = round(cor(GNIPerCapita, Mortality_U5_Total, use = "complete.obs"),3),
            LifeExp_correlation = round(cor(GNIPerCapita, LifeExp_Total, use = "complete.obs"),3)
            ) %>% kable(caption="GNI Per Capita Correlation to Mortality and Life Expectancy" ) %>% kable_styling(full_width = FALSE,position='left')
```


In the next Table \@ref(tab:table2) it examines the 10 countries in the OECD with the lowest Average GNI Per Capita from 2000 to 2020. It also includes the Rank of Life Expectancy and Mortality among the 37 countries. Notably, the analysis reveals that the 5 countries with the lowest Average GNI per Capita exhibit the lowest (unordered) ranks for Mortality and also demonstrate lower ranks for Life Expectancy. These findings suggest an association between lower GNI per Capita and poorer health outcomes in relation to Life Expectancy and Infant Mortality.


```{r table2, fig.cap="Countries with 10 Lowest Average GNI Per Capita"}
df %>% group_by(Country_Name) %>%
  summarise("Avg GNI Per Capita" = round(mean(GNIPerCapita),2),
            "Avg Life Expectancy" = round(mean(LifeExp_Total),2),
            "Avg Mortality U5" = round(mean(Mortality_U5_Total),2)) %>%
  arrange(`Avg GNI Per Capita`) %>%
  mutate("Rank Life Expectancy" = rank(-`Avg Life Expectancy`),
         "Rank Mortality U5" = rank(`Avg Mortality U5`)) %>%
  arrange(`Avg GNI Per Capita`) %>% head(10) %>% kable(caption="Countries with 10 Lowest Average GNI Per Capita") %>% kable_styling(full_width = FALSE, position = "left")
```







# Analysis by Hongmei

In this section, our research concentrates on examining the correlation between health expenditure as a percentage of GDP and overall life expectancy at birth to understand if higher healthcare investment translates into longer life spans. On the other hand, a specific focus also will be placed on exploring a comparative analysis of a select group of representative OECD countries, focusing on how their health expenditure influences child mortality rates under the age of 5, this comparative study aims to uncover regional differences and insights into how distinct health system structures and spending levels impact crucial health outcomes, specifically in child health. 

(1) The relationship between health expenditure with life expectation in OECD


```{r figure-plot, fig.cap="Health Expenditure vs Life Expectation at Birth in OECD Countries"}

# Plotting the relationship between health expenditure and life expectation for each year
ggplot(df, aes(x = HealthExp_percent_GDP, y = LifeExp_Total)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue") + # Adds a linear regression line
  labs(title = "Health Expenditure vs Life Expectation in OECD Countries",
       x = "Health Expenditure as % of GDP", 
       y = "Life Expectation at Birth") +
  theme_minimal()

```

As show in Figure \@ref(fig:figure-plot), it illustrates a discernible **positive** relationship between health expenditure as a percentage of GDP and life expectancy at birth in OECD countries. This trend implies a potential association between greater health care investment and improved health outcomes, as evidenced by increased life expectancy. 

(2) The relationship between health expenditure with mortality rate under 5 in representative countries

```{r figure-plot2, fig.cap="Health Expenditure vs Mortality Rate in representative countries of OECD"}

representative_countries <- c("USA", "CAN", "GBR", "DEU", "SWE",
                              "NZL", "MEX", "JPN", "KOR", "AUS")

# Filter the dataset
filtered_data <- df %>%
                 filter(Country_Code %in% representative_countries)
# Plot the relationship between health expenditure and mortality rate in representative countries
p <- ggplot(filtered_data, aes(x = HealthExp_percent_GDP, y = Mortality_U5_Total, text = Country_Name)) +
     geom_line(aes(color = Country_Name)) +
     labs(title = "Health Expenditure vs Mortality Rate in representative countries of OECD",
          x = "Health Expenditure",
          y = "Mortality Rate Under 5") +
     theme_minimal()
interactive_plot <- ggplotly(p, tooltip = c("text", "x", "y"))
interactive_plot
```

In the Figure \@ref(fig:figure-plot2),  ten representative OECD countries were carefully selected to encompass a variety of healthcare systems, including universal healthcare, insurance-based, and mixed systems. The selection also includes countries that have undergone significant health reforms, such as Mexico and South Korea, and those with notable demographic characteristics, like Japan's large population and aging society. This figure illustrates the relationship between health expenditure and infant mortality rates in these countries. A general trend is observed where higher health expenditure correlates with lower infant mortality rates, indicating a significant **negative** correlation and highlighting the impact of financial investment on health outcomes. **Notably**, the USA stands out with its higher level of health expenditure compared to other countries. However, Mexico deviates from this general trend, exhibiting a fluctuating relationship and a higher infant mortality rate than might be expected given its health expenditure level. This anomaly suggests that factors other than expenditure, such as efficiency of healthcare delivery or socio-economic conditions, may also play a critical role in determining health outcomes.

(3) Summary statistics of health expenditure and health outcome indicators in the selected countries

```{r}
# Calculate summary statistics
summary_stats <- filtered_data %>%
  group_by(Country_Name) %>%
  summarise(across(c(HealthExp_percent_GDP, Mortality_U5_Total, LifeExp_Total),
                   list(mean = ~ mean(., na.rm = TRUE), var = ~ var(., na.rm = TRUE))))
# Make column name shorter and meaningful
colnames(summary_stats) <- c("Country", "Mean_HealthExp", "Var_HealthExp", 
                             "Mean_MortU5", "Var_MortU5", "Mean_LifeExp", "Var_LifeExp")
# Display the table
kable(summary_stats, caption = "Summary Statistics of Health Expenditure and Health Indicators in Selected Countries", format = "html") %>%
  kable_styling(full_width = TRUE)
```

Table 1 provides a summary of the mean and variance in health expenditure alongside key health indicators, presenting a thorough quantitative analysis. The USA stands out with the highest health expenditure, yet it also shows a relatively higher variance in this spending, as well as in mortality rates. In contrast, Canada displays high average health expenditure, but with much lower variance, demonstrating consistency in its healthcare investments. On the other hand, countries like Mexico and Korea present notable variances in their health expenditure, suggesting complex underlying dynamics that merit deeper investigation. Intriguingly, Japan achieves a higher life expectancy and lower mortality rate with moderate health expenditure, underscoring the potential efficiency of its insurance-based health system. 

(4) Correlation between health expenditure with health outcome indicators

```{r}
# Correlation between Health Expenditure, Mortality under 5 and Life Expectancy at birth
correlation_stats <- filtered_data %>%
    group_by(Country_Name) %>%
    summarise(
      Cor_Heal_Mort = cor(HealthExp_percent_GDP, Mortality_U5_Total, use = "complete.obs"),
      Cor_Heal_Life = cor(HealthExp_percent_GDP, LifeExp_Total, use = "complete.obs")
      )
kable(correlation_stats, caption = "Correlation between Health Expenditure, Mortality under 5 and Life Expectancy", format = "html") %>%
  kable_styling(full_width = TRUE)

```
<br>
Table 2 reveals a general trend where health expenditure in most countries has a **strong negative** correlation with the mortality rate under 5 years and a positive correlation with life expectancy. However, there are notable exceptions. The United States, for example, despite its high health expenditure, shows a relatively lower positive correlation (0.6117293) with life expectancy. This suggests that increased spending does not correspond with a proportionate increase in life expectancy, possibly reflecting inefficiencies or other influencing factors. Mexico presents a distinct case, displaying a much weaker negative correlation with life expectancy (-0.1723541) and a less pronounced relationship between health expenditure and the reduction of mortality under 5 years. These anomalies in the Mexican context point towards potential systemic issues in healthcare delivery or socio-economic factors impacting health outcomes.

# Conclusion

 

Our comprehensive analysis of the relationship between economic indicators and health outcomes within OECD countries from 2000 to 2022 has yielded insightful results. Our first analysis focusing on GNI per Capita resulted in a downward trend in infant mortality rates as GNI per Capita rises, underscoring the impact of economic prosperity on child health. Simultaneously, there was an upward trend in life expectancy with increasing GNI per Capita highlighting the positive association between economic well-being and overall life expectancy. The examination of the 10 countries with the lowest Average GNI per Capita further supported these trends, indicating that lower economic prosperity is linked to weaker life expectancy and higher infant mortality rates.

Furthermore, the examination of health expenditure as a percentage of GDP reveals a generally negative correlation with infant mortality rates and a positive correlation with life expectancy. This finding suggests that higher healthcare investment is beneficial, but the impact is not uniform across all OECD countries. The cases of the USA and Mexico are particularly illuminating. Despite high health expenditure, the USA shows a less pronounced increase in life expectancy, while Mexico, with its unique challenges, demonstrates that high spending does not always translate into better health outcomes. These variations point to the necessity of considering factors beyond financial investment, such as efficiency of healthcare delivery and socio-economic conditions.

In conclusion, this study provides critical evidence of the links between economic health indicators and health outcomes. While increased economic wealth and healthcare spending generally correlate with better health metrics, the relationship is nuanced and influenced by a multitude of factors. These findings emphasize the need for tailored health policies and investments that consider the specific contexts and challenges of each country to optimize health outcomes.


# References

---
nocite: |
  @mortandhealth, @worldbank_wdi
---






