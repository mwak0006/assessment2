---
title: "Assessment 2"
author: "Mitchell Wake and Hongmei Zhang"
date: "2023-11-07"
output: 
  bookdown::html_document2:
    css: "style.css"
    number_sections: false 
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(tidyverse)
library(kableExtra)
library(ggplot2)
library(knitr)
df <- read.csv("data/cleaned_data.csv")

```



# Introduction


# Analysis by Mitch

In this analysis we aim to explore the relationship between Gross Net Income (GNI) per Capita and key health indicators, specifically focusing on infant mortality and life expectancy. The two research questions are as follows

1. Is there a relationship between GNI Per Capita and the infant mortality rate among children aged less than 5 years in OECD Countries.

2. Is there a relationship between GNI Per Capita and life expectancy at birth of countries in the OECD 


In the first figure \@ref(fig:scatterplot1), a scatterplot shows the relationship between Mortality Rates among children under 5 and GNI Per Capita for OECD countries spanning the years 2000 to 2022. The plot illustrates a downward trend, indicating that as GNI Per Capita rises, there is a tendency for infant mortality to decline.

```{r scatterplot1, fig.cap="Scatter Plot of Mortality Rate Under 5 years and GNI Per Capita", message=FALSE}
df %>%
  ggplot(aes(x = GNIPerCapita, y = Mortality_U5_Total)) + 
  geom_point() +
  geom_smooth( se = FALSE) +
  labs(title="Scatter Plot of Mortality Rate Under 5 years and GNI Per Capita",
       subtitle="OECD Countries from 2000 to 2022",
       y="Mortality Rate Under 5 years",
       x="GNI Per Capita") 
```
In the second figure \@ref(fig:scatterplot2), a scatterplot shows the relationship between Life Expectancy at birth and GNI Per Capita for OECD countries spanning the years 2000 to 2022. The plot illustrates an upward trend, indicating that as GNI Per Capita rises, Life Expectancy increases.

```{r scatterplot2, fig.cap="Scatter Plot of Life Expectancy and GNI Per Capita"}
df %>%
  ggplot(aes(x = GNIPerCapita, y = LifeExp_Total)) + 
  geom_point() +
  geom_smooth( se = FALSE) +
  labs(title="Scatter Plot of Life Expectancy and GNI Per Capita",
       subtitle="OECD Countries from 2000 to 2022",
       y="Life Expectancy at birth",
       x="GNI Per Capita") 
```
To measure the strength of these associations, correlation coefficients were calculated for GNI Per Capita with Mortality Rates and Life Expectancy. Referring to Table \@ref(tab:correlations), the results show a moderately negative correlation of **-0.526** between GNI and Mortality, indicating an inverse relationship. Conversely, a positive correlation of **0.706** is observed between GNI and Life Expectancy, showing a strong positive relationship.


```{r correlations, fig.cap="GNI Per Capita Correlation to Mortality and Life Expectancy"}
df %>%
  summarize(Mortality_U5_correlation = round(cor(GNIPerCapita, Mortality_U5_Total, use = "complete.obs"),3),
            LifeExp_correlation = round(cor(GNIPerCapita, LifeExp_Total, use = "complete.obs"),3)
            ) %>% kable(caption="GNI Per Capita Correlation to Mortality and Life Expectancy" ) %>% kable_styling(full_width = FALSE,position='left')
```


Our second table @ref(tab:table2) examines the 10 countries in the OECD with the lowest Average GNI Per Capita from 2000 to 2020. It also includes the Rank of Life Expectancy and Mortality among the 37 countries. Notably, the analysis reveals that the 5 countries with the lowest Average GNI per Capita exhibit the lowest (unordered) ranks for Mortality and also demonstrate lower ranks for Life Expectancy. These findings suggest an association between lower GNI per Capita and weaker trends in Life Expectancy and Infant Mortality.


```{r table2, fig.cap="Countries with 10 Lowest Average GNI Per Capita"}
df %>% group_by(Country_Name) %>%
  summarise("Avg GNI Per Capita" = round(mean(GNIPerCapita),2),
            "Avg Life Expectancy" = round(mean(LifeExp_Total),2),
            "Avg Mortality U5" = round(mean(Mortality_U5_Total),2)) %>%
  arrange(`Avg GNI Per Capita`) %>%
  mutate("Rank Life Expectancy" = rank(-`Avg Life Expectancy`),
         "Rank Mortality U5" = rank(`Avg Mortality U5`)) %>%
  arrange(`Avg GNI Per Capita`) %>% head(10) %>% kable(caption="Countries with 10 Lowest Average GNI Per Capita") %>% kable_styling(full_width = FALSE, position = "left")
```







# Analysis by Hongmei


# Conclusion


# References